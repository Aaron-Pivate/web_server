(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[531],{34687:function(C){C.exports={container:"container___1sYa-",lang:"lang___l6cji",content:"content___2zk1-",icon:"icon___rzGKO"}},80979:function(C,I,a){"use strict";a.r(I),a.d(I,{default:function(){return X}});var se=a(18106),F=a(35576),re=a(34792),Z=a(48086),v=a(8870),m=a(3182),T=a(2824),ne=a(17462),G=a(76772),O=a(94043),o=a.n(O),Y=a(89366),N=a(2603),K=a(29985),P=a(67294),R=a(5550),y=a(33597),V=a(16434),r=a(21010);function w(M,f){return S.apply(this,arguments)}function S(){return S=(0,m.Z)(o().mark(function M(f,p){return o().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",(0,r.WY)("/api/login/captcha",(0,v.Z)({method:"GET",params:(0,v.Z)({},f)},p||{})));case 1:case"end":return h.stop()}},M)})),S.apply(this,arguments)}var W=a(34687),c=a.n(W),J=a(93874),e=a(85893),$=function(f){var p=f.content;return(0,e.jsx)(G.Z,{style:{marginBottom:24},message:p,type:"error",showIcon:!0})},Q=function(){var f=(0,P.useState)({}),p=(0,T.Z)(f,2),L=p[0],h=p[1],k=(0,P.useState)("account"),z=(0,T.Z)(k,2),B=z[0],q=z[1],U=(0,r.tT)("@@initialState"),x=U.initialState,_=U.setInitialState,i=(0,r.YB)(),ee=function(){var d=(0,m.Z)(o().mark(function t(){var u,l;return o().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,x==null||(u=x.fetchUserInfo)===null||u===void 0?void 0:u.call(x);case 2:if(l=s.sent,!l){s.next=6;break}return s.next=6,_(function(j){return(0,v.Z)((0,v.Z)({},j),{},{currentUser:l})});case 6:case"end":return s.stop()}},t)}));return function(){return d.apply(this,arguments)}}(),ae=function(){var d=(0,m.Z)(o().mark(function t(u){var l,g,s,j,b,D,E;return o().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,J.w.login((l=u.username)!==null&&l!==void 0?l:"",u.password);case 3:return g=n.sent,s=i.formatMessage({id:"pages.login.success",defaultMessage:"\u767B\u5F55\u6210\u529F\uFF01"}),localStorage.setItem("token",g.token),Z.default.success(s),n.next=9,ee();case 9:if(r.m8){n.next=11;break}return n.abrupt("return");case 11:j=r.m8.location.query,b=j,D=b.redirect,r.m8.push(D||"/"),n.next=21;break;case 16:n.prev=16,n.t0=n.catch(0),console.log(n.t0),E=i.formatMessage({id:"pages.login.failure",defaultMessage:"\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5\uFF01"}),Z.default.error(E);case 21:case"end":return n.stop()}},t,null,[[0,16]])}));return function(u){return d.apply(this,arguments)}}(),A=L.status,H=L.type;return(0,e.jsxs)("div",{className:c().container,children:[(0,e.jsx)("div",{className:c().lang,"data-lang":!0,children:r.pD&&(0,e.jsx)(r.pD,{})}),(0,e.jsx)("div",{className:c().content,children:(0,e.jsxs)(R.Z,{initialValues:{autoLogin:!0},onFinish:function(){var d=(0,m.Z)(o().mark(function t(u){return o().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,ae(u);case 2:case"end":return g.stop()}},t)}));return function(t){return d.apply(this,arguments)}}(),children:[(0,e.jsxs)(F.Z,{activeKey:B,onChange:q,children:[(0,e.jsx)(F.Z.TabPane,{tab:i.formatMessage({id:"pages.login.accountLogin.tab",defaultMessage:"\u8D26\u6237\u5BC6\u7801\u767B\u5F55"})},"account"),(0,e.jsx)(F.Z.TabPane,{tab:i.formatMessage({id:"pages.login.phoneLogin.tab",defaultMessage:"\u624B\u673A\u53F7\u767B\u5F55"})},"mobile")]}),A==="error"&&H==="account"&&(0,e.jsx)($,{content:i.formatMessage({id:"pages.login.accountLogin.errorMessage",defaultMessage:"\u8D26\u6237\u6216\u5BC6\u7801\u9519\u8BEF(admin/ant.design)"})}),B==="account"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(y.Z,{name:"username",fieldProps:{size:"large",prefix:(0,e.jsx)(Y.Z,{className:c().prefixIcon})},placeholder:i.formatMessage({id:"pages.login.username.placeholder",defaultMessage:"\u7528\u6237\u540D: admin or user"}),rules:[{required:!0,message:(0,e.jsx)(r._H,{id:"pages.login.username.required",defaultMessage:"\u8BF7\u8F93\u5165\u7528\u6237\u540D!"})}]}),(0,e.jsx)(y.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,e.jsx)(N.Z,{className:c().prefixIcon})},placeholder:i.formatMessage({id:"pages.login.password.placeholder",defaultMessage:"\u5BC6\u7801: ant.design"}),rules:[{required:!0,message:(0,e.jsx)(r._H,{id:"pages.login.password.required",defaultMessage:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"})}]})]}),A==="error"&&H==="mobile"&&(0,e.jsx)($,{content:"\u9A8C\u8BC1\u7801\u9519\u8BEF"}),B==="mobile"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(y.Z,{fieldProps:{size:"large",prefix:(0,e.jsx)(K.Z,{className:c().prefixIcon})},name:"mobile",placeholder:i.formatMessage({id:"pages.login.phoneNumber.placeholder",defaultMessage:"\u624B\u673A\u53F7"}),rules:[{required:!0,message:(0,e.jsx)(r._H,{id:"pages.login.phoneNumber.required",defaultMessage:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\uFF01"})},{pattern:/^1\d{10}$/,message:(0,e.jsx)(r._H,{id:"pages.login.phoneNumber.invalid",defaultMessage:"\u624B\u673A\u53F7\u683C\u5F0F\u9519\u8BEF\uFF01"})}]}),(0,e.jsx)(V.Z,{fieldProps:{size:"large",prefix:(0,e.jsx)(N.Z,{className:c().prefixIcon})},captchaProps:{size:"large"},placeholder:i.formatMessage({id:"pages.login.captcha.placeholder",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"}),captchaTextRender:function(t,u){return t?"".concat(u," ").concat(i.formatMessage({id:"pages.getCaptchaSecondText",defaultMessage:"\u83B7\u53D6\u9A8C\u8BC1\u7801"})):i.formatMessage({id:"pages.login.phoneLogin.getVerificationCode",defaultMessage:"\u83B7\u53D6\u9A8C\u8BC1\u7801"})},name:"captcha",rules:[{required:!0,message:(0,e.jsx)(r._H,{id:"pages.login.captcha.required",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801\uFF01"})}],onGetCaptcha:function(){var d=(0,m.Z)(o().mark(function t(u){var l;return o().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,w({phone:u});case 2:if(l=s.sent,l!==!1){s.next=5;break}return s.abrupt("return");case 5:Z.default.success("\u83B7\u53D6\u9A8C\u8BC1\u7801\u6210\u529F\uFF01\u9A8C\u8BC1\u7801\u4E3A\uFF1A1234");case 6:case"end":return s.stop()}},t)}));return function(t){return d.apply(this,arguments)}}()})]}),(0,e.jsx)("div",{style:{marginBottom:24},children:(0,e.jsx)("a",{style:{display:"block",textAlign:"end"},children:(0,e.jsx)(r._H,{id:"pages.login.forgotPassword",defaultMessage:"\u5FD8\u8BB0\u5BC6\u7801"})})})]})})]})},X=Q}}]);
